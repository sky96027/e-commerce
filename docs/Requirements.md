# 목차

---

1. [개요](#개요)
2. [주요 기능](#주요-기능)
    1. [공통 기능](#공통-기능)
    2. [사용자 기능](#사용자-기능)
    3. [관리자 기능](#관리자-기능)
3. [사용자 역할 및 권한](#사용자-역할-및-권한)
4. [요구 사항 분석](#요구-사항-분석)
    1. [잔액](#잔액)
    2. [상품](#상품)
    3. [쿠폰](#쿠폰)
    4. [주문](#주문)
    5. [결제](#결제)
    6. [인기 상품](#인기-상품)
5. [추가 고려 사항 및 제약 사항](#추가-고려-사항-및-제약-사항)
6. [변경 이력](#변경-이력)

# 개요

---

해당 프로젝트는 e-커머스 상품 주문 서비스 구현을 목적으로 한다.

결제는 미리 충전된 잔액을 이용하며 고객은 여러개의 상품을 선택해 주문할 수 있다.

판매량이 가장 높은 상품을 추천 리스트(인기 상품)로 보여준다.

# 주요 기능

---

### 📌 공통 기능

- 잔액 조회 API
- 상품 목록 조회 API
- 인기 상품 조회 API

### 👤 사용자 기능

- 주문 API
- 결제 API
- 잔액 충전 API
- 선착순 쿠폰 수령 API

### 🛠 관리자 기능

- 선착순 쿠폰 발급 API
- 상품 등록 API

# 서비스 흐름도

---

# 사용자 역할 및 권한

---

### 👤 1. 일반 사용자 (고객)

- **주요 권한**
    - 상품 목록 및 상세 정보 조회
    - 잔액 충전 및 조회
    - 상품 주문
    - 상품 결제
    - 선착순 쿠폰 수령 및 사용
    - 인기 상품 목록 조회

---

### 🛠 2. 관리자

- **주요 권한**
    - 상품 등록 및 관리
    - 선착순 쿠폰 발급 설정 (수량, 기간 등)
    - 판매 데이터 분석(통계 기반 인기 상품 등)

---

### ⚙️ 3. 시스템 (내부 처리 역할)

- **주요 역할**
    - 주문 요청 시 잔액 차감 및 재고 확인
    - 인기 상품 통계를 자동 집계 (최근 3일간 판매 기준)

# 요구 사항 분석

---

## 잔액

### **기능적 요구 사항**

1. **잔액 조회 기능**
    1. 사용자는 본인의 현재 잔액을 확인할 수 있어야 한다.
    2. 관리자는 사용자의 ID로 해당 사용자의 잔액을 확인할 수 있어야 한다.
2. **잔액 충전 기능**
    1. 사용자는 원하는 금액만큼 잔액을 충전할 수 있어야 한다.
    2. 충전 금액은 양수여야 한다.
    3. 이미 존재하는 잔액에 충전 금액을 더하여 업데이트한다.
    4. 업데이트 후 사용자의 잔액은 10,000,000보다 많을 수 없다.

### **비 기능적 요구 사항**

1. 동일 사용자가 동시에 사용, 충전 요청이 들어와도 금액이 잘못 반영되지 않도록 해야한다. (동시성 처리)
2. 결제 중 오류 발생 시 잔액이 차감되지 않아야 한다. (트랜잭션 처리)
3. 잔액 계산은 소수점 오류 없이 정수 단위로 안전하게 처리되어야 한다.
4. 향후 포인트/쿠폰 등 확장 가능한 구조로 설계되어야 한다.

---

## 상품

### **기능적 요구 사항**

1. **상품 조회 기능**
    1. 사용자는 상품의 이름, 가격, 상품 옵션, 상품 재고를 조회할 수 있다.
    2. 상품 목록에는 상품 재고가 남아있는 제품만 표시된다.
    3. 상품 재고는 상품의 옵션 별로 나뉘어 표시된다.
2. **상품 등록 및 수정 기능**
    1. 관리자는 상품을 새로 등록할 수 있다.
    2. 관리자는 등록된 상품의 재고를 수정할 수 있다.
    3. 상품 재고는 상품의 옵션 별로 나뉘어 관리된다.

### **비 기능적 요구 사항**

1. 여러 사용자가 동시에 상품을 주문해도 재고 수량이 정확하게 반영되어야 한다. (동시성 처리)
2. 상품 등록 또는 수정 중 오류 발생 시, 잘못된 데이터가 저장되지 않도록 해야한다. (트랜잭션 처리)

---

## 쿠폰

### **기능적 요구 사항**

1. **쿠폰 조회 기능**
    1. 사용자는 자신이 보유한 쿠폰(ID, 쿠폰 이름, 할인율, 만료 기간 등)을 조회할 수 있어야 한다.
2. **쿠폰 발급 기능**
    1. 관리자는 쿠폰 이름과 쿠폰 정책, 발급량을 입력하여 선착순 할인 쿠폰을 발급할 수 있다.
3. **쿠폰 수령 기능**
    1. 사용자는 선착순으로 쿠폰을 수령받을 수 있다.
    2. 사용자는 쿠폰을 수령할 때 이미 수령한 쿠폰인지 검증한다. (ID로 중복 발급 검증)
    3. 사용자가 쿠폰을 수령할 때 발급 기간 내여야 한다.
    4. 사용자가 쿠폰을 수령할 때 쿠폰 잔량이 존재해야 한다. (수량 검증)

### **비 기능적 요구 사항**

1. 쿠폰 수령은 선착순 조건을 정확히 보장해야 한다. (동시성 처리)
2. 쿠폰 관련 API는 응답 속도가 빠르고, 대량 트래픽에도 안정적으로 동작해야 한다.

---

## 주문

### 기능적 요구 사항

1. **주문 기능**
    1. 사용자는 여러 상품을 한 번에 주문할 수 있다.
    2. 상품의 재고가 부족할 경우 결제가 취소된다.
    3. 사용자는 한 상품에 대해 유효한 쿠폰으로 할인을 받을 수 있다.
    4. 총 금액을 계산한다.

---

## 결제

### **기능적 요구 사항**

1. **결제 기능**
    1. 사용자는 상품의 금액만큼 잔액을 사용할 수 있어야 한다.
    2. 사용 금액은 양수여야 한다.
    3. 결제 후 이미 존재하는 잔액에 사용 금액을 감하여 업데이트한다.
    4. 업데이트 후 사용자의 잔액은 0보다 적을 수 없다.
    5. 결제 성공 시, 주문 정보를 외부 데이터 플랫폼으로 실시간 전송해야 한다.
    - 데이터 플랫폼 연동은 Mock API 또는 외부 모듈로 구현 가능
    6. 결제 성공 후, 주문된 상품 옵션의 재고는 주문 수량만큼 차감되어야 한다.

### **비 기능적 요구 사항**

1. 결제 시 상품 재고가 정확하게 반영되어야 한다. (동시성 및 트랜잭션 처리)

---

## 인기 상품

### **기능적 요구 사항**

1. 관리자와 사용자는 최근 3일간 주문량이 많은 상품 리스트를 조회할 수 있다.

### **비 기능적 요구 사항**

1. 인기 상품 리스트는 배치 스케쥴러로 자동화되어야 한다.

---

# 추가 고려 사항 및 제약 사항

---

- 성능 향상을 위해 인기 상품 리스트 등에 대하여 캐시가 필요할 지 고려가 필요.
- 동시성 처리가 정확히 이루어져야 함.
- 외부 데이터 플랫폼 연동 가능성을 고려해야 함.
- 다중 인스턴스 환경에서 일관성을 유지해야 함.

---

# 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
| --- | --- | --- | --- |
| 1.0 | 2025-07-14 | 김윤기 | 최초 작성 |